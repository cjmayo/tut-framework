<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <title>TUT: C++ Template Unit Test Framework</title>
    <link rel="shortcut icon" href="tut.ico" />
    <meta charset='utf-8'>
    <meta name="keywords" content="C++ Unit Test Simple" />
    <meta name="description" content="TUT: C++ Template Unit Test Framework" />
    <meta name="generator" content="webgen - http://webgen.rubyforge.com/" />
    <link href="default.css" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <a href="https://github.com/mrzechonek/tut-framework"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub"></a>
    <div id="header">
      <h1>
        <a href="http://mrzechonek.github.io/tut-framework"><img src="tut.png" alt="tut logo"/></a>
        C++ Template Unit Test Framework
      </h1>
    </div>

    <div id="menu">
        <ul><li class="webgen-menu-level1"><a href="index.html" hreflang="en">Introduction</a></li><li class="webgen-menu-level1"><a href="news.html" hreflang="en">News</a></li><li class="webgen-menu-level1"><a href="download.html" hreflang="en">Download</a></li><li class="webgen-menu-level1"><a href="example.html" hreflang="en">Example</a></li><li class="webgen-menu-level1"><a href="howto.html" hreflang="en">How To</a></li><li class="webgen-menu-level1 webgen-menu-item-selected"><a href="faq.html" hreflang="en">FAQ</a></li><li class="webgen-menu-level1"><a href="authors.html" hreflang="en">Authors</a></li><li class="webgen-menu-level1"><a href="links.html" hreflang="en">Links</a></li><li class="webgen-menu-level1"><a href="copyright.html" hreflang="en">Copyright</a></li><li class="webgen-menu-level1"><a href="https://github.com/mrzechonek/tut-framework/issues">Issues</a></li><li class="webgen-menu-level1"><a href="doxygen/index.html">Reference Manual</a></li></ul>
    </div>

    <div id="body">
        <h1><span>frequently asked questions</span>FAQ </h1>
        
<ul><li class="webgen-menu-level1"><a href="#what-is-tut">What is TUT?</a></li><li class="webgen-menu-level1"><a href="#how-is-it-different-from-cunit-boosttest-">How is it different from C++Unit (boost::test, …)?</a></li><li class="webgen-menu-level1"><a href="#which-compilers-are-supported">Which compilers are supported?</a></li><li class="webgen-menu-level1"><a href="#can-we-test-private-methods">Can we test private methods?</a></li><li class="webgen-menu-level1"><a href="#can-we-use-strings-as-test-names-please">Can we use strings as test names, please?</a></li><li class="webgen-menu-level1"><a href="#how-about-test-fixtures-setupteardown-methods">How about test fixtures (setUp/tearDown methods)?</a></li><li class="webgen-menu-level1"><a href="#ive-taken-a-look-at-the-selftest-code-and-it-looks-awful">I’ve taken a look at the selftest code and it looks awful</a></li><li class="webgen-menu-level1"><a href="#is-it-possible-to-have-more-50-tests-per-group">Is it possible to have more 50 tests per group?</a></li><li class="webgen-menu-level1"><a href="#ive-used-ensureequals-method-and-compiler-refused-to-build-my-code-complaining-that-there-is-ambiguous-overload-for-operator">I’ve used ensure_equals() method and compiler refused to build my code complaining that there is ambiguous overload for operator«.</a></li><li class="webgen-menu-level1"><a href="#what-about-segmentation-faults-in-code-being-tested-what-about-deadlocks">What about segmentation faults in code being tested? What about deadlocks?</a></li><li class="webgen-menu-level1"><a href="#what-is-this-multi-process-testing-mentioned-in-the-summary">What is this multi-process testing mentioned in the summary?</a></li><li class="webgen-menu-level1"><a href="#where-can-i-ask-a-question">Where can I ask a question?</a></li></ul>

<h2 id="what-is-tut">What is TUT?</h2>
<p>TUT is a small and portable unit test framework for C++. It’s so small that it fits into
one header file. It’s so portable that it could be used on almost any C++ platform, including
Windows, MacOS, Unices and embedded devices.</p>

<h2 id="how-is-it-different-from-cunit-boosttest-">How is it different from C++Unit (boost::test, …)?</h2>
<p>C++Unit, boost::test and other frameworks has similar goals, but there are some issues with many of them:
*    they require to use a library
*    tests depend on preprocessor macros
*    they often overloaded with features</p>

<p>TUT, in contrast, is located in header files only. All you should do is to include it into the test module.
No linking at all.</p>

<p>TUT uses C++ template engine to dispatch calls to test methods. Therefore you shouldn’t even register methods
s tests; template will do it for you automatically. As a result, the test code is more readable.</p>

<p>And finally, TUT is a minimal software. It only does what it’s designed for. 
It doesn’t integrate with MSDN or control production processes. It just runs tests.</p>

<h2 id="which-compilers-are-supported">Which compilers are supported?</h2>
<p>Most modern compilers are supported.
Some outdated compilers are unable to handle templates in TUT, alas.</p>

<p>Supported:
*    GNU GCC 2.95
*    GNU GCC 3.x (both under unix and <a href="http://www.mingw.org">MinGW</a>)
*    Borland 5.6 (Borland C++ Builder 6)
*    Intel C++ Compiler 6.x
*    Intel C++ Compiler 8.1
*    Sun Studio 9: C++ 5.6 Compiler
*    Microsoft VC7 (Microsoft VS.NET 2003 and later)
*    Sun WorkShop 6 update 2 C++ 5.3 (probably, previous versions as well)</p>

<p>Unsupported:
*    Borland 5.5.x (Borland C++ Builder 5)
*    Microsoft VC6 (including SP5)
*    Microsoft VC7 (Microsoft VS.NET 2002)
*    C for AIX Compiler, Version 6
*    KAI C++ Compiler
*    Portland Group Compiler, Version 5.2-4</p>

<p>If you use TUT with any other compiler or environment please let me know.</p>

<p>Some broken compiler/linker/platform combinations require to make methods ensure(),
ensure_equals and fail() to be inline, and not in anonymous namespace. Try to
change tut.h accordingly if you see “duplicate symbol ensure” or “ensure is not found” 
during linking stage.</p>

<h2 id="can-we-test-private-methods">Can we test private methods?</h2>
<p>Alas.</p>

<p>First, from a pure theoretical POV, testing private methods is considered harmful as it exposes class internals,
while traditional testing focuses on public interface only.</p>

<p>Second, it’s just plain impossible in C++ without making TUT a friend of tested class. It is strongly discouraged,
since it makes actual implementation dependant on TUT internals. Don’t be surprised if things do not compile with
next release.</p>

<p>If you really must, friend declaration should look like this:</p>

<div class="CodeRay">
  <div class="code"><pre>
<span style="color:#777">// forward declaration is necessary</span>
namespace tut
{
    template&lt;typename T&gt;
    class test_object;
}

class MyClass
{
    template&lt;typename T&gt;
    friend class tut::test_object;

    <span style="color:#777">// code follows</span>
}
</pre></div>
</div>

<p>On the other hand, most compilers do not change the ABI when moving private section around, so exposing all internals to TUT might be
as simple as below. Your mileage may vary, though.</p>

<div class="CodeRay">
  <div class="code"><pre>
<span style="color:#579">#define</span> private public
<span style="color:#579">#define</span> protected public
<span style="color:#579">#include</span> <span style="color:#B44;font-weight:bold">&quot;MyClass.h&quot;</span>

<span style="color:#777">// test code follows</span>
</pre></div>
</div>

<h2 id="can-we-use-strings-as-test-names-please">Can we use strings as test names, please?</h2>
<p>No and yes. C++ template engine doesn’t support usage of run-time objects (and string <span class="accent">is</span>
a run-time object) for specialization. Compile-time constants is the only way.</p>

<p>On the other hand, there is a method set_test_name(“a name”) which you can call in the beginning of a test to make it look
prettier in the failed build report.</p>

<h2 id="how-about-test-fixtures-setupteardown-methods">How about test fixtures (setUp/tearDown methods)?</h2>
<p>To aquire resources before the test and to release them right after the test 
use constructor and destructor of the data structure:</p>

<div class="CodeRay">
  <div class="code"><pre>
<span style="color:#777">// ...</span>
<span style="color:#080;font-weight:bold">struct</span> complex_data 
{ 
    connection* con;
    complex_data() { con = db_pool.get_connection(); } 
    ~complex_data() { db_pool.release_connection(con); } 
};

template&lt;&gt; 
template&lt;&gt; 
<span style="color:#088;font-weight:bold">void</span> testobject::test&lt;<span style="color:#00D">1</span>&gt;() 
{ 
    <span style="color:#777">// ...</span>
    con-&gt;commit();
}
</pre></div>
</div>

<p>Each test in the group from now on will have the connection initialized by 
constructor and released in destructor.</p>

<p>What would happen if the constructor throws an exception? TUT will treat it as if test itself
failed with an exception. The test body won’t be executed and it will be reported as failed with
exception. But the destructor of the data structure will be executed anyway!</p>

<p>An exception in the destructor is threated differently though. Reaching destruction phase means
that the <em>test itself</em> has finished successfuly. In this case TUT marks 
the test with a warning status.</p>

<h2 id="ive-taken-a-look-at-the-selftest-code-and-it-looks-awful">I’ve taken a look at the selftest code and it looks awful</h2>
<p>Self tests are very special beasties, and actually you’ve seen 
two(!) TUT frameworks running one under control of another. The case is 
quite extreme. Regular TUT tests are very simple to read.</p>

<h2 id="is-it-possible-to-have-more-50-tests-per-group">Is it possible to have more 50 tests per group?</h2>
<p>Yes. A newly created group has a predefined set of dummy tests (i.e. test placeholders).
By default, there are 50 tests in a group. To create a test group with a higher 
volume (e.g. when tests are generated by a script) provide a higher border of 
test group size when it is instantiated: </p>

<div class="CodeRay">
  <div class="code"><pre>
<span style="color:#777">// test group with maximum 500 tests </span>
<span style="color:#080;font-weight:bold">typedef</span> test_group&lt;huge_test_data,<span style="color:#00D">500</span>&gt; testgroup;
</pre></div>
</div>

<p>Note that your compiler would possibly need a command-line switch or pragma to enlarge
the recursive instantiation depth. For g++, for example, you should specify –ftemplate-depth-501
to make example above compile. Please consult your compiler’s documentation. </p>

<h2 id="ive-used-ensureequals-method-and-compiler-refused-to-build-my-code-complaining-that-there-is-ambiguous-overload-for-operator">I’ve used ensure_equals() method and compiler refused to build my code complaining that there is ambiguous overload for operator«.</h2>
<p>One or both types you’ve provided to ensure_equals() have no operator « at all. 
Since the diagnostic message is built using std::stringstream, compiler needs the 
operator to format your objects. Either add the operator or use ensure() method 
(which doesn’t tell you the exact values the objects had, just the fact they were not equal).</p>

<h2 id="what-about-segmentation-faults-in-code-being-tested-what-about-deadlocks">What about segmentation faults in code being tested? What about deadlocks?</h2>
<p>C++ Standard doesn’t specify what happens if the code references
wrong address. Thus, segmentation fault processing is system and compiler dependent,
and shall be handled differently for each system/compiler pair.</p>

<p>If you want TUT to react correctly to tests failures caused by segfaults,
you must somehow convert hardware faults into C++ exceptions.</p>

<p>For Win32 TUT uses SEH. You need to specify -DTUT_USE_SEH at the test build time.</p>

<p>For unixes there is no standard way to convert SIGSEGV into an exception.
Consult your platform/compiler documentation for possible ways to do that.</p>

<p>You may also use restartable wrapper defined in optional header 
<code>tut_restartable.h</code>. It runs the tests the same way
as regular runner does, but also logs the progress. If a test crashes the test 
application, and then test application is started again, the wrapper will load last 
log record, and continue test execution from position after the crashed one.</p>

<p>Of course, this requires helper script that runs test application
until all tests will be runned. The script might be is as simple as:
&lt;div class="CodeRay"&gt;
  &lt;div class="code"&gt;&lt;pre&gt;
while true
do
  ./restartable &amp;amp;&amp;amp; exit 0
done
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;</p>

<p>Directory <code>examples/restartable</code> contains a simple restartable test application.</p>

<p>This approach can be extended to support deadlocks in code. The script
must be modified to automatically kill test application after specified
period of time.</p>

<h2 id="what-is-this-multi-process-testing-mentioned-in-the-summary">What is this multi-process testing mentioned in the summary?</h2>
<p>It allows spawning child processes on platforms that support it. This is often
needed when testing client/server applications. Using TUT, one can fork the
main process and use ensure_* functions in both processes. Moreover, one
can ensure that spawned processes exited, were killed etc.</p>

<p>TUT takes care of all necessary cleanup: all spawned processes are stopped
after current test case finishes.</p>

<h2 id="where-can-i-ask-a-question">Where can I ask a question?</h2>
<p>TUT has a small <a href="http://sourceforge.net/forum/forum.php?forum_id=719643">forum</a> on SourceForge.
Feel free to post your comments, questions and bug-reports there.</p>


    </div>

    <div id="footer">

        <h1>
            <span>last change: 2013-12-18 11:22:17 +0100</span>
            <a href="http://validator.w3.org/check?uri=referer"><img src="http://www.w3.org/Icons/valid-xhtml11" alt="Valid XHTML 1.1" height="31" width="88" /></a>
            generated by <a href="http://webgen.gettalong.org">webgen</a>
        </h1>
    </div>
  </body>
</html>

<!--
    vim:ft=xhtml
 -->
